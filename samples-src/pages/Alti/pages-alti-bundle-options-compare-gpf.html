{{#extend "layout-sample-bundle"}}

{{#content "head"}}
        <title>Service de Calcul Altimétrique : comparaison GPF / ancien service</title>
{{/content}}

{{#content "style"}}
        <style></style>
{{/content}}

{{#content "body"}}
        <div id="params">
            <p>
              longitude 1 :
              <input type="text" id="lon1" size="10" /> latitude 1 :
              <input type="text" id="lat1" size="10" />
            </p>
            <p>
              longitude 2 :
              <input type="text" id="lon2" size="10" /> latitude 2 :
              <input type="text" id="lat2" size="10" />
            </p>
            <p>
              sampling (nombre de points intermédaires) :
              <input type="text" id="sampling" size="5" />
            </p>
            <p>
              <input type="checkbox" id="zonly" value="true" />zonly
            </p>
          </div>
          <div id="go">
            <input type="button" value="getAltitude" onclick="go()" />
        </div>
        <h1>GEOPLATEFORME : Utilisation du Service de Calcul Altimétrique</h1>
        <div id="result1" class="results"></div>

        <h1>WXS : Utilisation du Service de Calcul Altimétrique</h1>
        <div id="result2" class="results"></div>
{{/content}}

{{#content "js"}}
function go() {
    // récupération des options du formulaire

    var lon1 = document.getElementById("lon1").value;
    var lat1 = document.getElementById("lat1").value;
    var lon2 = document.getElementById("lon2").value;
    var lat2 = document.getElementById("lat2").value;
    var zonly= document.getElementById("zonly").checked;
    var sampling = document.getElementById("sampling").value;
    var resultDiv = document.getElementById("result");
    var positions = [];
    if (lon1 && lat1) positions.push({
      lon: lon1,
      lat: lat1
    });
    if (lon2 && lat2) positions.push({
      lon: lon2,
      lat: lat2
    });

    // Appel service WXS
    Gp.Services.getAltitude({
        positions: positions,
        sampling: sampling,
        apiKey: "calcul",
        zonly: zonly,
        oldAltiService : true,
        resource : "none",
        onSuccess: function(result) {
            print(result.elevations, "result1");
        },
        onFailure: function(error) {
          resultDiv.innerHTML = "<p>" + error + "</p>"
        }
    });

    // Appel service GPF
    Gp.Services.getAltitude({
        positions: positions,
        sampling: sampling,
        apiKey: "calcul",
        zonly: zonly,
        onSuccess: function(result) {
            print(result.elevations, "result2");
        },
        onFailure: function(error) {
          resultDiv.innerHTML = "<p>" + error + "</p>"
        }
    });
}
{{/content}}
{{/extend}}
